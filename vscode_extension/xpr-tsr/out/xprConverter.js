var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});let Console_1=__importDefault(require("./Console")),xprTokenizer_1=require("./xprTokenizer");class XprConverter{static nameRegex=/^[A-Z0-9_]+$/;static identifierRegex=/^\/.*$/;static convert(e){e=xprTokenizer_1.XprTokenizer.tokenize(e);this.buildTree(e)}static buildTree(e){let r=null,n=null;if("@name"===e.nextToken()){if(null!==r)return void Console_1.default.error("@nameを2度宣言することはできません。");if(null===(r=this.parseName(e)))return}if("@includes"===e.nextToken()){if(null!==n)return void Console_1.default.error("@includesを2度宣言することはできません。");if(null===(n=this.parseIncludes(e)))return}console.log(r),console.log(n)}static parseName(e){var r=e.nextToken();return null===r||","===r?(Console_1.default.error("@nameの後に識別子が指定されていません。"),null):this.nameRegex.test(r)?(r=r,","!==e.nextToken()?(Console_1.default.error("@name識別子の後はカンマ`,`もしくは改行を入れなければいけません。"),null):r):(Console_1.default.error("@name識別子は英数字またはアンダースコア`_`の組み合わせでなければいけません。"),null)}static parseIncludes(e){var r;if("{"!==e.nextToken())return Console_1.default.error("@includesブロックが開始されていません。"),null;for(var n=[];;){if("}"===(r=e.nextToken())){if(0===n.length)return Console_1.default.error("@includesにはディレクトリを最低でも1つ指定する必要があります。"),null;break}if(null===r)return Console_1.default.error("@includesにディレクトリが指定されていません。"),null;if(!this.identifierRegex.test(r))return Console_1.default.error("@includesで指定するディレクトリはスラッシュ`/`から始める必要があります。"),null;n.push(r),","!==e.nextToken()&&Console_1.default.error("@includesの各ディレクトリの後はカンマ`,`もしくは改行を入れなければいけません。")}return n}}exports.default=XprConverter;